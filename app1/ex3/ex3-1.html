<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>JRostand stade reperes</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />
</head>

<body>

    <h1>JRostand Reperes Stade</h1>
    <hr>
    <div id="map">...</div>

    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7Y32T_PJHZxYcK3BJYJFNwSl6cuvLXpo&callback=loadDoc&v=weekly" defer   ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
    let map; // Déclaration globale pour la carte

    function loadDoc() {
        $.ajax({
            url: 'markersJrostand.json', 
            method: 'GET',       
            dataType: 'json',    
            success: function (markers) {
                    // Initialisation de la carte
                    map = new google.maps.Map(document.getElementById("map"), {
                        zoom: 16,
                        center: { lat: 48.9605, lng: 2.5480 }, // centre de la zone
                    });

                    // InfoWindow réutilisable
                    const infoWindow = new google.maps.InfoWindow();

                    for (let i = 0; i < markers.length; i++) {
                        const markerData = markers[i];

                        let marker = new google.maps.Marker({
                            position: { lat: markerData.lat, lng: markerData.lng },
                            map: map,
                            title: `Repère ${i + 1}`
                        });

                        console.log(`Repère ${i + 1}:`, markerData);

                        // Deux lieux avec InfoWindow
                        if (i === 0) { // Repère 1 : Stade Jean Rostand
                            marker.addListener('click', function () {
                                infoWindow.setContent(`
                                    <div>
                                        <h3>Stade Jean Rostand</h3>
                                        <p>Terrain de sport du lycée. Utilisé pour l'EPS et les activités scolaires.</p>
                                    </div>
                                `);
                                infoWindow.open(map, marker);
                            });
                        } else if (i === 3) { // Repère 4 : Parc des Sports
                            marker.addListener('click', function () {
                                infoWindow.setContent(`
                                    <div>
                                        <h3>Parc des Sports</h3>
                                        <p>Un espace pour pratiquer du sport ou se détendre en plein air.</p>
                                    </div>
                                `);
                                infoWindow.open(map, marker);
                            });
                        } else {
                            // Alerte pour les autres repères
                            marker.addListener('click', function () {
                                alert(`Vous avez cliqué sur le repère ${i + 1}`);
                            });
                        }
                    }
                },
                error: function (err) {
                    console.error("Erreur lors du chargement des marqueurs :", err);
                }
            });
        }
    </script>

</body>

</html>